;=======================================================================
; Motorola 68K - ASM test
; Simple ODD values counter asm test
;=======================================================================

assert_zero EQU $00D0000C

;=======================================================================
;    DC.L     0
;    DC.L     START
;    SECTION  .fastram
;=======================================================================

SIZE    EQU 400 ; $190       ; number of ODD values in array.
PRECALC EQU 192 ; $C0        ; precalculated number of ODD values in array.

;=======================================================================

start:
     clr     D0               ; current value in array
     clr     D1               ; odd values counter
     clr     D7               ; loop counter
     lea     array,A0         ; load array
     move.w  #SIZE-1,D7       ; load array size
loop:
     ;move.b  (A0)+,D0        ; read array value
     move.b  (A0,D7),D0       ; read array value
     btst    #0,D0            ; is ODD value ?
     beq     .even            ; 
     addq.l  #1,D1            ; increment counter
.even
     dbra    D7,loop          ; continue

;=======================================================================

selftest:
     sub.w   #PRECALC,D1      ; substract precalc value to calculated value
     move.l  D1,assert_zero   ; raise error if D1 != 0

;=======================================================================

     stop    #-1              ; stop execution

;=======================================================================

array:
     dc.b $85,$73,$3F,$C6,$77,$D5,$67,$95,$A8,$70,$31,$AC,$2D,$17,$CC,$80
     dc.b $F1,$75,$3C,$56,$74,$4A,$51,$88,$99,$A7,$54,$D2,$53,$1C,$F7,$B4
     dc.b $EF,$FF,$ED,$20,$C6,$34,$25,$90,$7F,$88,$F8,$9C,$4B,$1F,$F0,$7B
     dc.b $93,$E9,$BD,$36,$28,$0F,$E9,$50,$97,$DD,$2C,$26,$D4,$77,$F1,$3C
     dc.b $32,$BD,$C1,$A6,$F7,$46,$01,$4F,$FA,$75,$14,$FB,$69,$59,$5D,$07
     dc.b $AF,$82,$8A,$EE,$A1,$22,$5F,$6C,$D4,$E9,$D4,$2B,$17,$66,$93,$5C
     dc.b $7A,$6E,$BE,$1F,$6C,$F1,$B4,$34,$AE,$64,$BB,$93,$3A,$22,$55,$08
     dc.b $FB,$BD,$D2,$3C,$16,$AB,$20,$2A,$FB,$46,$4E,$0F,$C5,$64,$1A,$8C
     dc.b $AF,$E8,$58,$6B,$E9,$9D,$94,$DE,$B8,$86,$A9,$59,$3B,$10,$44,$57
     dc.b $21,$A4,$DA,$B5,$2C,$A0,$D9,$D9,$C9,$F8,$B1,$EC,$74,$06,$45,$2C
     dc.b $83,$A0,$D8,$FE,$3B,$F3,$D2,$08,$C2,$36,$5E,$88,$10,$27,$C5,$8A
     dc.b $E3,$C6,$5E,$E3,$9B,$58,$74,$50,$DA,$8D,$C5,$E9,$A3,$34,$2E,$5A
     dc.b $A5,$7B,$AC,$1B,$DB,$46,$40,$AA,$56,$AA,$48,$38,$B5,$8E,$BB,$1F
     dc.b $3F,$3B,$6B,$A8,$86,$26,$4B,$B1,$EE,$E0,$88,$69,$8E,$AF,$B9,$E9
     dc.b $ED,$3C,$3D,$28,$00,$69,$60,$AD,$1F,$0A,$BB,$D1,$ED,$9B,$42,$E5
     dc.b $07,$09,$E7,$35,$A0,$92,$EA,$0D,$0A,$D9,$02,$7A,$62,$6D,$16,$5D
     dc.b $5B,$EC,$1B,$0C,$0D,$7C,$4F,$C8,$3D,$02,$46,$67,$56,$8B,$CD,$9A
     dc.b $25,$D0,$45,$01,$98,$1E,$3D,$BE,$95,$29,$4F,$89,$22,$1B,$CC,$EF
     dc.b $7B,$31,$6E,$01,$22,$72,$45,$30,$97,$4D,$C8,$32,$C4,$8E,$A9,$D2
     dc.b $A3,$A3,$09,$14,$89,$FD,$0C,$71,$08,$36,$02,$5A,$3E,$CC,$9A,$07
     dc.b $CB,$C9,$BE,$13,$87,$C6,$5D,$AA,$01,$56,$0C,$E5,$1A,$71,$BD,$C5
     dc.b $EC,$BE,$68,$9A,$EC,$C9,$73,$F5,$9D,$19,$72,$C1,$B6,$00,$ED,$4E
     dc.b $B7,$77,$B3,$0A,$51,$BE,$64,$EC,$7D,$12,$06,$B3,$DA,$9D,$72,$3A
     dc.b $58,$BC,$04,$EB,$69,$C6,$E9,$34,$62,$65,$98,$9E,$F5,$62,$9A,$1C
     dc.b $1D,$ED,$24,$DE,$FE,$45,$08,$3D,$46,$4A,$88,$67,$62,$9D,$21,$0C

;=======================================================================
